db.players.aggregate([
    { $project: { _id: 1, last_name: 1, first_name: 1, season_stats: 1 } },
    { $unwind: "$season_stats" },
    { $project: { 
        _id: 1, 
        last_name: 1, 
        first_name: 1, 
        completions: "$season_stats.completions", 
        passing_tds: "$season_stats.passing_tds", 
        passing_td_pts: { $multiply: [4 ,"$season_stats.passing_tds" ] },
        passing_yards: "$season_stats.passing_yards",
        passing_yards_pts: { $multiply: [ 1, { $divide: [ "$season_stats.passing_yards", 25 ] } ] },
        interceptions: "$season_stats.interceptions", 
        interception_pts: { $multiply: [ -2, "$season_stats.interceptions" ] },
        rush_attempts: "$season_stats.rush_attempts", 
        rush_yards: "$season_stats.rush_yards",
        rush_yards_pts: { $multiply: [ 1, { $divide: [ "$season_stats.rush_yards", 10 ] } ] },
        rush_tds: "$season_stats.rush_tds",
        rush_td_pts: { $multiply: [ 6, "$season_stats.rush_tds" ] },
        fumbles: "$season_stats.fumbles",
        fumble_pts: { $multiply: [ -2, "$season_stats.fumbles" ] },
        receptions: "$season_stats.receptions",
        reception_pts: { $multiply: [ 1, "$season_stats.receptions" ] },
        receive_yards: "$season_stats.receive_yards",
        receive_yard_pts: { $multiply: [ 1, { $divide: [ "$season_stats.receive_yards", 10 ] } ] },
        receive_tds: "$season_stats.receive_tds",
        receive_td_pts: { $multiply: [ 6, "$season_stats.receive_tds" ] },
        fantasy_points: { $add: [ 
            { $multiply: [4 ,"$season_stats.passing_tds" ] },
            { $multiply: [ 1, { $divide: [ "$season_stats.passing_yards", 25 ] } ] },
            { $multiply: [ -2, "$season_stats.interceptions" ] },
            { $multiply: [ 1, { $divide: [ "$season_stats.rush_yards", 10 ] } ] },
            { $multiply: [ 6, "$season_stats.rush_tds" ] },
            { $multiply: [ -2, "$season_stats.fumbles" ] },
            { $multiply: [ 1, "$season_stats.receptions" ] },
            { $multiply: [ 1, { $divide: [ "$season_stats.receive_yards", 10 ] } ] },
            { $multiply: [ 6, "$season_stats.receive_tds" ] },
         ] },
        } },
    { $group: { 
        _id: { $concat: [ "$last_name", ", ", "$first_name" ] }, 
        avg_completions: { $avg: "$completions" },
        avg_passing_tds: { $avg: "$passing_tds" },
        avg_passing_td_pts: { $avg: "$passing_td_pts" },
        avg_passing_yards: { $avg: "$passing_yards" },
        avg_passing_yards_pts: { $avg: "$passing_yards_pts" },
        avg_interceptions: { $avg: "$interceptions" },
        avg_interception_pts: { $avg: "$interception_pts" },
        avg_rush_attempts: { $avg: "$rush_attempts" },
        avg_rush_yards: { $avg: "$rush_yards" },
        avg_rush_yard_pts: { $avg: "$rush_yards_pts" },
        avg_rush_tds: { $avg: "$rush_tds" },
        avg_rush_td_pts: { $avg: "$rush_td_pts" },
        avg_fumbles: { $avg: "$fumbles" },
        avg_fumble_pts: { $avg: "$fumble_pts" },
        avg_receptions: { $avg: "$receptions" },
        avg_reception_pts: { $avg: "$reception_pts" },
        avg_receive_yards: { $avg: "$receive_yards" },
        avg_receive_yard_pts: { $avg: "$receive_yard_pts" },
        avg_receive_tds: { $avg: "$receive_tds" },
        avg_receive_td_pts: { $avg: "$receive_td_pts" },
        avg_fantasy_points: { $avg: "$fantasy_points" },
        } 
    },
    { $sort: { avg_fantasy_points: -1 } },
])